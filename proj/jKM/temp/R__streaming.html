<html>
	<head>
		<style type="text/css">
			
    body {    font-family: arial;   line-height:24px    }
    pre {    font-family: arial    }
    table {    border: 1px solid #666666;    border-collapse: collapse;    }
    td,th {    border: 1px solid #666666;    padding: 5;     font-size: 10pt;    text-align:center;    }
    th {    background-color: FFDDBB;  }
    a:link    {        color: #0000FF;        text-decoration: none;    }
    a:visited    {        color: #0000FF;        text-decoration: none;    }
    a:hover    {        color: #FF0000;        text-decoration: underline;    }
    a:active    {        color: #FF0000;        text-decoration: underline;    }

		</style>
		<META content="text/html" http-equiv="Content-Type">
		</META>
	</head>
	<body>
		<script src="http://code.jquery.com/jquery-1.10.1.min.js">
		</script>
		
    <script>
        $(document).ready(function(){
        		$("[class='v']").mouseover(function(){    
        			$(this).css("background-color","#EEEEFF");
        		})
                	$("[class='v']").mouseout(function(){    
        			$(this).css("background-color","#FFFFFF");
        		})
        
        	var infoStatus=0
        	$("[name='infoButton']").css("color", "#0000FF");
        	$("[name='info']").css("display", "none");
        
        	$("[name='infoButton']").click(function(){
        		if(infoStatus==1){
        			$("[name='info']").fadeOut();
        			$(this).css("color", "#0000FF");
        		}
        		else{
        			$("[name='info']").fadeIn();
        			$(this).css("color", "#FF0000");
        		}
        		infoStatus=1-infoStatus;
        	});
         
        	var remarkStatus=1
        	$("[name='remarkButton']").css("color", "#FF0000");
        	$("[name='remarkButton']").click(function(){
        		if(remarkStatus==1){
        			$("[class='remark']").fadeOut();
        			$(this).css("color", "#0000FF");
        		}
        		else{
        			$("[class='remark']").fadeIn();
        			$(this).css("color", "#FF0000");
        		}
        		remarkStatus=1-remarkStatus;
        	});
    
        	var imageStatus=1
        	$("[name='imageButton']").css("color", "#FF0000");
        	$("[name='imageButton']").click(function(){
        		if(imageStatus==1){
        			$("[name='image']").fadeOut();
        			$(this).css("color", "#0000FF");
        		}
        		else{
        			$("[name='image']").fadeIn();
        			$(this).css("color", "#FF0000");
        		}
        		imageStatus=1-imageStatus;
        	});
         
        });
    </script>
    
		
    <p style="font-size:18pt">streaming
        <font style="font-size:10pt;color:red">&nbsp;&nbsp;&nbsp;&nbsp;incomplete</font>
    </p>
    <table width="100%" style="border-style:none">
        <tr>
            <td style="border-style:none;text-align:left;vertical-align:top">
                <font style="font-size:10pt">Hadoop Streaming with R</font>
            </td>
            <td style="border-style:none;text-align:right;vertical-align:top">
                <a href="#" name="infoButton">
                    info
                </a>
                &nbsp;|&nbsp;
                <a href="#" name="remarkButton">
                    remark
                </a>
                &nbsp;|&nbsp;
                <a href="#" name="imageButton">
                    image
                </a>
            </td>
        </tr>
    </table>
    <hr />
    
	<style type="text/css">
        img {border-style:dotted;border-width:1px;box-shadow:4px 4px 3px rgba(20%,20%,40%,0.5)}
        .infoTable_1 {border-style:none;text-align:right;vertical-align:top;background-color:#FFEEFF}
        .infoTable_2 {border-style:none;text-align:left;vertical-align:top;background-color:#FFEEFF}
        .indent {border-style:none}
        .k {border-style:none;text-align:left;vertical-align:top}
        .v {border-style:none;text-align:left;vertical-align:top}
        .r {border-style:none;text-align:left;vertical-align:top}
	</style>
    <div name="info">
        <table width="100%" style="border-style:none">
            <tr>
                <td class="infoTable_1">Description:</td>
                <td class="infoTable_2" width="100%">Hadoop Streaming with R</td>
            </tr>
            <tr>
                <td class="infoTable_1">Status:</td>
                <td class="infoTable_2">incomplete</td>
            </tr>
            <tr>
                <td class="infoTable_1">Tags:</td>
                <td class="infoTable_2">datetime</td>
            </tr>
            <tr>
                <td class="infoTable_1">Author:</td>
                <td class="infoTable_2">Josh.Li</td>
            </tr>
            <tr>
                <td class="infoTable_1">CreateDate:</td>
                <td class="infoTable_2"></td>
            </tr>
            <tr>
                <td class="infoTable_1">UpdateDate:</td>
                <td class="infoTable_2"></td>
            </tr>
        </table>
    </div>
    
		<table style="border-style:none;">
			<tr>
				<td class="indent">
				</td>
				<td class="k">
					<b>Process</b>
				</td>
				<td class="v">
				</td>
				<td class="r">
				</td>
			</tr>
		</table>
		<table style="border-style:none;">
			<tr>
				<td class="indent">
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
				<td class="k">
					<b>data</b>
				</td>
				<td class="v">
				</td>
				<td class="r">
				</td>
			</tr>
		</table>
		<table style="border-style:none;">
			<tr>
				<td class="indent">
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
				<td class="k">
					<font color="red">*</font>
				</td>
				<td class="v">
					120.8808,24.7108,140617-1503,C0E420,19.0,28.3,0.78,999.2,206.0,2.1,0.0,-99.0,7.1,92
<br />120.9921,24.6032,140617-1503,C0E430,258.0,29.6,0.61,977.4,188.0,3.4,0.0,-99.0,10.5,26
<br />120.7578,24.4128,140617-1503,C0E530,341.0,25.3,0.90,967.2,213.0,3.3,0.0,-99.0,9.8,211
<br />121.2377,24.2450,140617-1503,C0F860,2215.0,14.9,1.00,778.4,223.0,1.6,0.0,-99.0,4.7,247
<br />121.2641,24.1448,140617-1503,C0H9C0,3402.0,8.7,1.00,674.6,320.0,3.1,0.5,-99.0,-9.9,-99
<br />120.5736,23.3264,140617-1503,C0M410,245.0,24.1,0.96,974.8,0.0,0.2,0.5,-99.0,-9.9,-99
<br />120.2894,23.1144,140617-1503,C0O900,9.0,26.6,0.97,1005.6,140.0,2.1,1.5,-99.0,3.3,148
<br />120.4525,23.1278,140617-1503,C0O930,69.0,25.4,1.00,999.3,0.0,0.0,4.5,-99.0,0.0,0
<br />120.3939,22.8950,140617-1503,C0V370,30.0,26.0,0.98,999.0,75.0,0.7,2.0,-99.0,1.6,59
<br />120.5111,22.9006,140617-1503,C0V310,46.0,26.2,0.99,1001.4,62.0,0.7,5.5,-99.0,1.9,58
				</td>
				<td class="r">
				</td>
			</tr>
		</table>
		<table style="border-style:none;">
			<tr>
				<td class="indent">
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
				<td class="k">
					<b>redtest.r</b>
				</td>
				<td class="v">
				</td>
				<td class="r">
				</td>
			</tr>
		</table>
		<table style="border-style:none;">
			<tr>
				<td class="indent">
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
				<td class="k">
					<font color="red">*</font>
				</td>
				<td class="v">
					#! /usr/bin/env Rscript
<br />options(warn=-1)
<br />sink("/tmp/logged")
<br />input &lt;- file("stdin", "r")
<br />while(length(currentLine &lt;- readLines(input, n=1, warn=FALSE)) > 0) {
<br />   fields &lt;- unlist(strsplit(currentLine, ","))
<br />   sink()
<br />   cat(fields[4], fields[5],"\n",sep="\t")
<br />   sink("/tmp/logged")
<br />}
<br />close(input)
<br />unlink("/tmp/logged")
<br />
				</td>
				<td class="r">
				</td>
			</tr>
		</table>
		<table style="border-style:none;">
			<tr>
				<td class="indent">
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
				<td class="k">
					<b>redtest.r</b>
				</td>
				<td class="v">
				</td>
				<td class="r">
				</td>
			</tr>
		</table>
		<table style="border-style:none;">
			<tr>
				<td class="indent">
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
				<td class="k">
					<font color="red">*</font>
				</td>
				<td class="v">
					#! /usr/bin/env Rscript
<br />options(warn=-1)
<br />sink("/tmp/logged")
<br />input &lt;- file("stdin", "r")
<br />i=0
<br />sumV=0
<br />while(length(currentLine &lt;- readLines(input, n=1, warn=FALSE)) > 0) {
<br />   fields &lt;- unlist(strsplit(currentLine, "\t"))
<br />   sink()
<br />   if(is.finite(as.double(fields[2]))){
<br />        i=i+1
<br />        sumV=sumV+as.double(fields[2])
<br />   }
<br />   sink("/tmp/logged")
<br />}
<br />sink()
<br />cat(sumV/i,"\n")
<br />unlink("/tmp/logged")
<br />close(input)
<br />
				</td>
				<td class="r">
				</td>
			</tr>
		</table>
		<table style="border-style:none;">
			<tr>
				<td class="indent">
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
				<td class="k">
					<b>stream</b>
				</td>
				<td class="v">
				</td>
				<td class="r">
				</td>
			</tr>
		</table>
		<table style="border-style:none;">
			<tr>
				<td class="indent">
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
				<td class="k">
					<font color="red">*</font>
				</td>
				<td class="v">
					hadoop jar /opt/ibm/biginsights/IHC/hadoop-streaming.jar \
<br />-input /tmp/rinput/list000 \
<br />-output /tmp/routput \
<br />-file /home/biadmin/maptest.r \
<br />-mapper maptest.r \
<br />-file /home/biadmin/redtest.r \
<br />-reducer redtest.r
				</td>
				<td class="r">
				</td>
			</tr>
		</table>
	</body>
</html>
